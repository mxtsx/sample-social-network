(this["webpackJsonpsocial-network"]=this["webpackJsonpsocial-network"]||[]).push([[0],{10:function(e,t,s){e.exports={profileInfoContainer:"ProfileInfo_profileInfoContainer__3a01q",photo:"ProfileInfo_photo__10dn2",inputWrapper:"ProfileInfo_inputWrapper__18ESu",description:"ProfileInfo_description__2tPzv",name:"ProfileInfo_name__1toHp",status:"ProfileInfo_status__2qqQF",elementOfDescription:"ProfileInfo_elementOfDescription__24Cpv",contact:"ProfileInfo_contact__g-nCp",contacts:"ProfileInfo_contacts__1WWgw",buttonUnderProfilePhoto:"ProfileInfo_buttonUnderProfilePhoto__3HD6c",descriptionForm:"ProfileInfo_descriptionForm__1ZKr2",elementOfDescriptionForm:"ProfileInfo_elementOfDescriptionForm__iYJUk",searchJob:"ProfileInfo_searchJob__1-CsB"}},116:function(e,t,s){e.exports={appContent:"App_appContent__2dvhY",main:"App_main__3bFf_"}},121:function(e,t,s){e.exports={footer:"Footer_footer__3vgN2",flaticonRef:"Footer_flaticonRef__3Z4nc"}},124:function(e,t,s){e.exports={container:"User_container__1llI1",profilePhoto:"User_profilePhoto__HCx9u"}},163:function(e,t,s){e.exports={preloaderWrapper:"Preloader_preloaderWrapper__1HRyV"}},165:function(e,t,s){e.exports={profileContainer:"Profile_profileContainer__3gPic"}},168:function(e,t,s){e.exports={loginFormContainer:"LoginForm_loginFormContainer__2TfL0"}},205:function(e,t,s){},25:function(e,t,s){e.exports={container:"Users_container__3Msvs",buttonContainer:"Users_buttonContainer__1pImp",usersList:"Users_usersList__2LnM-",arrowButton:"Users_arrowButton__1Zwnr",searchForm:"Users_searchForm__3qs1L",button:"Users_button__1bKQe",currentPage:"Users_currentPage__3LPNO"}},330:function(e,t,s){"use strict";s.r(t);var a=s(0),r=s.n(a),n=s(59),o=s.n(n);s(205);var i=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,340)).then((({getCLS:t,getFID:s,getFCP:a,getLCP:r,getTTFB:n})=>{t(e),s(e),a(e),r(e),n(e)}))},c=s(116),l=s.n(c),d=s(7),u=s(46),j=s(158);const h=s.n(j).a.create({baseURL:"https://social-network.samuraijs.com/api/1.0/",withCredentials:!0,headers:{"API-KEY":"86dfe136-7be0-4b1e-b813-164c7f450a17"}});let m,b;!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(m||(m={})),function(e){e[e.Captcha=10]="Captcha"}(b||(b={}));const p={getAuth:()=>h.get("auth/me"),login:(e,t,s=!1,a=null)=>h.post("auth/login",{email:e,password:t,rememberMe:s,captcha:a}),logout:()=>h.delete("auth/login"),captcha:()=>h.get("security/get-captcha-url")},O="auth/USER_AUTHENTICATION",f="auth/LOGOUT",g="auth/GET_CAPTCHA",x={id:null,email:null,login:null,auth:!1,captchaURL:null},v=(e,t,s,a=!1)=>({type:O,data:{id:e,email:t,login:s,auth:a}}),_=()=>({type:f}),w=e=>({type:g,captchaURL:e}),N=()=>async e=>{const t=await p.getAuth();if(0===t.data.resultCode){const{email:s,id:a,login:r}=t.data.data;e(v(a,s,r,!0))}else{const s=t.data.messages[0]?t.data.messages[0]:"Something goes wrong :(";e(Object(u.a)("login",{_error:s}))}},C=()=>async e=>{const t=(await p.captcha()).data.url;e(w(t))};var P=(e=x,t)=>{switch(t.type){case O:return{...e,...t.data};case f:return{...e,auth:!1};case g:return{...e,captchaURL:t.captchaURL};default:return e}},y=s(41),F=s.n(y),S=s(11),I=s(30),U=s.p+"static/media/logo.b47f6e0a.svg",E=s(336),L=s(1);var T=r.a.memo((({login:e,auth:t,userLogout:s})=>{const a=Object(S.h)().pathname;return Object(L.jsxs)("header",{className:F.a.headerContainer,children:[Object(L.jsxs)("div",{className:F.a.siteInfo,children:[Object(L.jsx)("img",{className:F.a.logo,src:U,alt:""}),Object(L.jsx)("div",{className:F.a.networkName,children:Object(L.jsx)("span",{children:"Sample Social Network"})})]}),Object(L.jsx)("div",{className:F.a.loginInfo,children:Object(L.jsx)("div",{className:F.a.loginContainer,children:t?Object(L.jsxs)("div",{children:[Object(L.jsx)("span",{className:F.a.login,children:e}),Object(L.jsx)(E.a,{type:"default",onClick:s,children:"Logout"})]}):"/login"!==a&&Object(L.jsx)(I.b,{to:"/login",activeClassName:F.a.active,children:Object(L.jsx)(E.a,{type:"default",children:"Login"})})})})]})}));const k=e=>e.auth.id,D=e=>e.auth.login,R=e=>e.auth.auth,M=e=>e.auth.captchaURL;class A extends a.Component{componentDidMount(){this.props.userAuthentication()}render(){return Object(L.jsx)(T,{login:this.props.login,auth:this.props.auth,userLogout:this.props.userLogout})}}var H=Object(d.b)((e=>({login:D(e),auth:R(e)})),{userAuthentication:N,userLogout:()=>async e=>{0===(await p.logout()).data.resultCode&&e(_())}})(A),W=s(42),z=s.n(W);var G=r.a.memo((e=>Object(L.jsx)("aside",{className:z.a.sidebar,children:Object(L.jsxs)("nav",{className:z.a.contentWrapper,children:[Object(L.jsx)("div",{className:z.a.link,children:Object(L.jsx)(I.b,{to:"/profile",activeClassName:z.a.active,children:"Profile"})}),Object(L.jsx)("div",{className:z.a.link,children:Object(L.jsx)(I.b,{to:"/users",activeClassName:z.a.active,children:"Users"})}),Object(L.jsx)("div",{className:z.a.link,children:Object(L.jsx)(I.b,{to:"/chat",activeClassName:z.a.active,children:"Chat"})})]})}))),J=s(121),B=s.n(J);var $=r.a.memo((e=>Object(L.jsxs)("footer",{className:B.a.footer,children:[Object(L.jsx)("div",{children:Object(L.jsx)("span",{children:"\xa9 2021"})}),Object(L.jsxs)("div",{className:B.a.flaticonRef,children:["Icons made by ",Object(L.jsx)("a",{href:"https://www.flaticon.com/authors/becris",title:"Becris",children:"Becris"})," and ",Object(L.jsx)("a",{href:"https://www.flaticon.com/authors/xnimrodx",title:"xnimrodx",children:"xnimrodx"})," from ",Object(L.jsx)("a",{href:"https://www.flaticon.com/",title:"Flaticon",children:"www.flaticon.com"})]})]}))),Y=s(10),q=s.n(Y),V=s.p+"static/media/preloader.fa017795.svg",K=s(163),Z=s.n(K);var Q=r.a.memo((e=>Object(L.jsx)("div",{className:Z.a.preloaderWrapper,children:Object(L.jsx)("img",{src:V,alt:""})}))),X=s.p+"static/media/avatarMan.0940a2e8.svg",ee=s.p+"static/media/avatarWoman.98c0bda7.svg",te=s(155);const se=e=>{if(!e)return"Field is required"};var ae=s(65),re=s.n(ae),ne=s(154);const oe=({meta:{touched:e,error:t},children:s,...a})=>{const r=e&&t;return Object(L.jsxs)("div",{className:r?re.a.error:"",children:[Object(L.jsx)("div",{children:s}),r&&Object(L.jsx)("div",{className:re.a.errorContainer,children:Object(L.jsx)("span",{children:t})})]})},ie=e=>{const{input:t,meta:s,...a}=e;return Object(L.jsx)(oe,{...e,children:Object(L.jsx)("input",{...t,...a})})},ce=e=>{const{input:t,meta:s,...a}=e;return Object(L.jsx)(oe,{...e,children:Object(L.jsx)("textarea",{...t,...a})})};function le(e,t,s,a,r="",n=[],o,i,c={}){return Object(L.jsxs)("div",{className:o,children:[Object(L.jsx)("span",{className:r&&re.a.formText,children:r})," ",Object(L.jsx)(ne.a,{placeholder:e,name:t,component:s,type:a,validate:n,...c})]})}const de=(ue=20,e=>{if(e&&e.length>ue)return`Max Length is ${ue} symbols`});var ue;const je=r.a.memo((({handleSubmit:e})=>Object(L.jsx)("form",{onBlur:e,className:q.a.status,children:le("","status",ie,void 0,"",[de])})));var he=Object(te.a)({form:"statusForm"})(je);var me=r.a.memo((({userStatus:e,setUserStatus:t,isOwner:s,isFetching:r})=>{const[n,o]=Object(a.useState)(!1),i={status:e};return r?Object(L.jsx)(Q,{}):Object(L.jsxs)("div",{children:[!n&&Object(L.jsx)("div",{className:q.a.status,children:Object(L.jsx)("span",{onDoubleClick:s?()=>{o(!0)}:void 0,children:e||(s?"Double click to set the status":"No status :(")})}),n&&Object(L.jsx)(he,{onSubmit:s=>{o(!1),s.status!==e&&t(s.status)},initialValues:i})]})}));var be=Object(te.a)({form:"profileDescriptionForm"})((({profile:e,handleSubmit:t})=>Object(L.jsx)("form",{onSubmit:t,children:Object(L.jsxs)("div",{className:q.a.descriptionForm,children:[Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:Object(L.jsx)("span",{children:Object(L.jsx)("b",{children:"Your name and some information about you:"})})}),Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:le("Your name","fullName",ie)}),Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:le("Some information","aboutMe",ie)}),Object(L.jsx)("div",{className:q.a.searchJob,children:Object(L.jsx)("span",{children:le("","lookingForAJob",ie,"checkbox","Looking for a job:",[],q.a.searchJob)})}),Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:Object(L.jsx)("span",{children:le("Your skills description","lookingForAJobDescription",ce)})}),Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:Object(L.jsx)("span",{children:Object(L.jsx)("b",{children:"Your Contacts:"})})}),Object(L.jsx)("div",{children:Object.keys(e.contacts).map((e=>Object(L.jsx)("div",{className:q.a.elementOfDescriptionForm,children:Object(L.jsx)("b",{children:le(e,`contacts.${e}`,ie)})},e)))})]}),Object(L.jsx)("div",{children:Object(L.jsx)(E.a,{type:"default",htmlType:"submit",size:"small",children:"Submit"})})]})})));const pe={getProfile:e=>h.get(`profile/${e}`),getUserStatus:e=>h.get(`profile/status/${e}`),updateUserStatus:e=>h.put("profile/status",{status:e}),updateProfileInformation:e=>h.put("profile",e),updateProfilePhoto(e){const t=new FormData;return t.append("image",e),h.put("profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}})}},Oe={getUsers:(e,t,s="",a=null)=>h.get(`users?count=${e}&page=${t}&term=${s}&friend=${a}`),follow:e=>h.post(`follow/${e}`,{}),unfollow:e=>h.delete(`follow/${e}`),isFollow:e=>h.get(`follow/${e}`).then((e=>e.data))},fe="profile/SET_USER_PROFILE",ge="profile/GET_USER_STATUS",xe="profile/SET_IS_FETCHING",ve="profile/SET_NEW_PHOTO",_e="profile/IS_USER_FOLLOWED",we={profile:null,status:"",isFetching:!1,isFollowed:null},Ne={getNewProfile:e=>({type:fe,profile:e}),getUserStatus:e=>({type:ge,status:e}),setIsFetching:e=>({type:xe,isFetching:e}),setNewPhoto:e=>({type:ve,photos:e}),userIsFollowed:e=>({type:_e,payload:{isFollowed:e}})},Ce=e=>async t=>{t(Ne.setIsFetching(!0));const s=await pe.getProfile(e);t(Ne.getNewProfile(s.data)),t(Ne.setIsFetching(!1))},Pe=e=>async t=>{const s=await pe.updateProfilePhoto(e);0===s.data.resultCode&&t(Ne.setNewPhoto(s.data.data.photos))};var ye=(e=we,t)=>{switch(t.type){case fe:return{...e,profile:t.profile};case ge:return{...e,status:t.status};case xe:return{...e,isFetching:t.isFetching};case ve:return{...e,profile:{...e.profile,photos:t.photos}};case _e:return{...e,isFollowed:t.payload.isFollowed};default:return e}};var Fe=r.a.memo((()=>{const e=Object(d.c)();return Object(L.jsx)("div",{className:q.a.inputWrapper,children:Object(L.jsx)("input",{type:"file",onChange:t=>{var s;(null===(s=t.target.files)||void 0===s?void 0:s.length)&&e(Pe(t.target.files[0]))}})})}));const Se=e=>e.usersPage.users,Ie=e=>e.usersPage.pageSize,Ue=e=>e.usersPage.totalUsersCount,Ee=e=>e.usersPage.currentPage,Le=e=>e.usersPage.isFetching,Te=e=>e.usersPage.followingIsFetching,ke=e=>e.usersPage.filter,De="users/GET_USERS",Re="users/GET_TOTAL_USERS_COUNT",Me="users/FOLLOW_UNFOLLOW_USER",Ae="user/SET_CURRENT_PAGE",He="user/SET_FILTER",We="user/FOLLOWING_IS_FETCHING",ze="user/SET_FETCHING",Ge={users:[],pageSize:3,totalUsersCount:0,currentPage:1,isFetching:!1,followingIsFetching:[],filter:{term:"",friend:null}},Je=(e=1)=>({type:Ae,currentPage:e}),Be=e=>({type:De,users:e}),$e=e=>({type:ze,isFetching:e}),Ye=e=>({type:He,payload:e}),qe=(e,t)=>({type:We,isFetching:e,id:t}),Ve=e=>({type:Re,totalUsers:e}),Ke=(e,t)=>({type:Me,followed:e,id:t}),Ze=(e,t,s)=>async a=>{a($e(!0)),a(Ye(s)),a(Je(t));const r=await Oe.getUsers(e,t,s.term,s.friend),{items:n,totalCount:o}=r.data;a(Be(n)),a(Ve(o)),a($e(!1))},Qe=async(e,t,s,a,r)=>{r(qe(!0,t));0===(await s(t)).data.resultCode&&r(a(e,t)),r(qe(!1,t))},Xe=e=>async t=>{const s=Oe.follow.bind(Oe),a=Ke;await Qe(!0,e,s,a,t)},et=e=>async t=>{const s=Oe.unfollow.bind(Oe),a=Ke;await Qe(!1,e,s,a,t)};var tt=(e=Ge,t)=>{switch(t.type){case Ae:return{...e,currentPage:t.currentPage};case Re:return{...e,totalUsersCount:t.totalUsers};case De:return{...e,users:[...t.users]};case ze:return{...e,isFetching:t.isFetching};case He:return{...e,filter:t.payload};case Me:return{...e,users:e.users.map((e=>e.id===t.id?{...e,followed:t.followed}:e))};case We:return{...e,followingIsFetching:t.isFetching?[...e.followingIsFetching,t.id]:e.followingIsFetching.filter((e=>e!==t.id))};default:return e}};const st=e=>e.profilePage.profile,at=e=>e.profilePage.status,rt=e=>e.profilePage.isFetching,nt=e=>e.profilePage.isFollowed,ot=e=>"a"===e[e.length-1],it=r.a.memo((({profile:e,userStatus:t,setUserStatus:s,isOwner:r,isFetching:n,setUserProfileUpdate:o})=>{var i;const[c,l]=Object(a.useState)(!1),u=Object(d.d)(nt),j=Object(d.d)(Te),h=Object(d.c)();Object(a.useEffect)((()=>()=>{h(Ne.getNewProfile(null)),h(Ne.userIsFollowed(null))}),[]),Object(a.useEffect)((()=>{var t;h((t=e.userId,async e=>{const s=await Oe.isFollow(t);e(Ne.userIsFollowed(s))}))}),[e.userId]);return n||null===u?Object(L.jsx)(Q,{}):Object(L.jsxs)("div",{className:q.a.profileInfoContainer,children:[Object(L.jsxs)("div",{className:q.a.photo,children:[Object(L.jsx)("img",{src:(null===e||void 0===e||null===(i=e.photos)||void 0===i?void 0:i.large)||(ot(e.fullName)?ee:X),alt:""}),r&&!c?Object(L.jsx)("div",{children:Object(L.jsx)("div",{className:q.a.buttonUnderProfilePhoto,children:Object(L.jsx)(E.a,{className:q.a.buttonUnderProfilePhoto,type:"default",onClick:()=>{l(!0)},children:"Edit Page"})})}):r?Object(L.jsx)(Fe,{}):u?Object(L.jsx)(E.a,{className:q.a.buttonUnderProfilePhoto,type:"default",disabled:j.some((t=>t===e.userId)),onClick:()=>{return t=e.userId,h(et(t)),void h(Ne.userIsFollowed(!1));var t},children:"Unfollow"}):!u&&!r&&Object(L.jsx)(E.a,{className:q.a.buttonUnderProfilePhoto,type:"default",disabled:j.some((t=>t===e.userId)),onClick:()=>{return t=e.userId,h(Xe(t)),void h(Ne.userIsFollowed(!0));var t},children:"Follow"})]}),c?Object(L.jsx)(be,{profile:e,initialValues:e,onSubmit:async e=>{await o(e),l(!1)}}):Object(L.jsx)(ct,{profile:e,userStatus:t,setUserStatus:s,isOwner:r,isFetching:n})]})})),ct=r.a.memo((({profile:e,userStatus:t,setUserStatus:s,isOwner:a,isFetching:r})=>{const n=Boolean(Object.values(e.contacts).map((e=>e)).filter((e=>e))[0]);return Object(L.jsxs)("div",{className:q.a.description,children:[Object(L.jsx)("div",{className:q.a.name,children:Object(L.jsx)("span",{children:null===e||void 0===e?void 0:e.fullName})}),Object(L.jsx)(me,{userStatus:t,setUserStatus:s,isOwner:a,isFetching:r}),(null===e||void 0===e?void 0:e.aboutMe)&&Object(L.jsx)("div",{className:q.a.elementOfDescription,children:Object(L.jsxs)("span",{children:[Object(L.jsx)("b",{children:"About me: "})," ",null===e||void 0===e?void 0:e.aboutMe]})}),Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:q.a.elementOfDescription,children:Object(L.jsxs)("span",{children:[Object(L.jsx)("b",{children:"Looking for a job:"})," ",(null===e||void 0===e?void 0:e.lookingForAJob)?"yes":"no"]})}),(null===e||void 0===e?void 0:e.lookingForAJob)&&Object(L.jsx)("div",{className:q.a.elementOfDescription,children:Object(L.jsxs)("span",{children:[Object(L.jsx)("b",{children:"My skills"}),": ",null===e||void 0===e?void 0:e.lookingForAJobDescription]})})]}),n&&Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:q.a.contact,children:Object(L.jsx)("span",{children:Object(L.jsx)("b",{children:"Contact me:"})})}),Object(L.jsx)("div",{children:Object.keys(e.contacts).map((t=>Object(L.jsx)(lt,{contactKey:t,contactValue:e.contacts[t]},t)))})]})]})})),lt=r.a.memo((({contactKey:e,contactValue:t,...s})=>Object(L.jsx)("div",{...s,children:t&&Object(L.jsx)("div",{className:q.a.elementOfDescription,children:Object(L.jsxs)("p",{className:q.a.contacts,children:[Object(L.jsxs)("b",{children:[e,":"]})," ",t]})})})));var dt=it,ut=s(165),jt=s.n(ut);var ht=a.memo((({status:e,profile:t,isFetching:s,setUserStatus:a,isOwner:r,setUserProfileUpdate:n,setNewProfilePhotos:o})=>t!==t?Object(L.jsx)(Q,{}):Object(L.jsx)("div",{className:jt.a.profileContainer,children:Object(L.jsx)(dt,{profile:t,userStatus:e,setUserStatus:a,isFetching:s,isOwner:r,setUserProfileUpdate:n,setNewProfilePhotos:o})}))),mt=s(13);const bt=e=>e.error.error,pt="error/SET_ERROR",Ot={error:null},ft=e=>({type:pt,payload:{error:e}}),gt=e=>async t=>{t(ft(e))};var xt=(e=Ot,t)=>{switch(t.type){case pt:return{...e,error:t.payload.error};default:return e}},vt=s(334);var _t=function(e){return r.a.memo((t=>{const s=Object(d.d)(bt),r=Object(d.c)();return Object(a.useEffect)((()=>()=>{s&&r(gt(null))}),[s]),s?Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(vt.a,{message:"Error",description:s,type:"error",showIcon:!0})}):Object(L.jsx)(e,{...t})}))};class wt extends r.a.PureComponent{refreshProfilePage(){let e=this.props.match.params.userID;e||(e=this.props.id,e)?(this.props.setUserProfile(e),this.props.getCurrentUserStatus(e)):this.props.history.push("/login")}componentDidMount(){this.refreshProfilePage()}componentDidUpdate(e,t){e.match.params.userID===this.props.match.params.userID&&e.status===this.props.status||this.refreshProfilePage()}render(){return!this.props.profile||this.props.isFetching?Object(L.jsx)(Q,{}):Object(L.jsx)(ht,{...this.props,isOwner:!this.props.match.params.userID})}}var Nt=Object(mt.d)(Object(d.b)((e=>({id:k(e),profile:st(e),status:at(e),isFetching:rt(e)})),{setUserProfile:Ce,getCurrentUserStatus:e=>async t=>{t(Ne.setIsFetching(!0));const s=await pe.getUserStatus(e);t(Ne.getUserStatus(s.data)),t(Ne.setIsFetching(!1))},setUserStatus:e=>async t=>{t(Ne.setIsFetching(!0));0===(await pe.updateUserStatus(e)).data.resultCode&&(t(Ne.getUserStatus(e)),t(Ne.setIsFetching(!1)))},setUserProfileUpdate:e=>async(t,s)=>{const a=s().auth.id;0===(await pe.updateProfileInformation(e)).data.resultCode&&await t(Ce(a))},setNewProfilePhotos:Pe,actions:Ne}),_t,S.i)(wt),Ct=s(124),Pt=s.n(Ct);var yt=a.memo((({user:e})=>{const t=Object(d.d)(Te),s=Object(d.c)();return Object(L.jsxs)("div",{className:Pt.a.container,children:[Object(L.jsx)(I.b,{to:`/profile/${e.id}`,children:Object(L.jsx)("img",{src:e.photos.large||(ot(e.name)?ee:X),alt:"",className:Pt.a.profilePhoto})}),Object(L.jsx)("div",{children:e.name}),Object(L.jsx)("div",{children:e.status}),e.followed&&Object(L.jsx)(E.a,{size:"small",type:"default",disabled:t.some((t=>t===e.id)),onClick:()=>{return t=e.id,void s(et(t));var t},children:"Unfollow"}),!e.followed&&Object(L.jsx)(E.a,{size:"small",type:"default",disabled:t.some((t=>t===e.id)),onClick:()=>{return t=e.id,void s(Xe(t));var t},children:"Follow"})]})})),Ft=s(25),St=s.n(Ft),It=s.p+"static/media/buttonLeft.e43ebb0d.svg",Ut=s.p+"static/media/buttonRight.7d765ffd.svg",Et=s.p+"static/media/buttonDoubleLeft.6471537b.svg",Lt=s.p+"static/media/buttonDoubleRight.5ea00a17.svg",Tt=s(80),kt=s(338),Dt=s(339);var Rt=r.a.memo((({onFilterChanged:e})=>{const t=Object(S.g)(),s=Object(d.d)(ke),a=!!t.location.search.length&&"currentPage"!==t.location.search.substring(1,12),r=()=>{e({term:"",friend:null})};return Object(L.jsx)("div",{className:St.a.searchForm,children:Object(L.jsx)(Tt.c,{enableReinitialize:!0,initialValues:{term:s.term,friend:String(s.friend)},onSubmit:(t,{setSubmitting:s})=>{const a={term:t.term,friend:"null"===t.friend?null:"true"===t.friend};e(a)},children:({isSubmitting:e})=>Object(L.jsxs)(Tt.b,{children:[Object(L.jsx)(Tt.a,{placeholder:"Enter friends name",type:"text",name:"term"}),Object(L.jsxs)(Tt.a,{as:"select",name:"friend",children:[Object(L.jsx)("option",{value:"null",children:"All"}),Object(L.jsx)("option",{value:"true",children:"Only followed"}),Object(L.jsx)("option",{value:"false",children:"Only unfollowed"})]}),Object(L.jsx)(E.a,{className:St.a.button,type:"default",htmlType:"submit",icon:Object(L.jsx)(kt.a,{}),disabled:e,shape:a?"circle":"round",children:!a&&"Search"}),a&&Object(L.jsx)(E.a,{className:St.a.button,type:"default",onClick:r,htmlType:"submit",icon:Object(L.jsx)(Dt.a,{}),shape:"circle"})]})})})})),Mt=s(125);var At=r.a.memo((()=>{const e=Object(d.d)(Se),t=Object(d.d)(Ee),s=Object(d.d)(Ie),r=Object(d.d)(Ue),n=Object(d.d)(Le),o=Object(d.d)(ke),i=Object(d.c)(),c=Object(S.g)();Object(a.useEffect)((()=>{const e={};o.term&&(e.term=o.term),null!==o.friend&&(e.friend=String(o.friend)),1!==t&&(e.currentPage=String(t)),c.push({pathname:"/users",search:Mt.stringify(e)})}),[o,t]),Object(a.useEffect)((()=>{const e=Mt.parse(c.location.search.substring(1));let a=t,r=o;e.term&&(r={...r,term:e.term}),e.friend&&(r={...r,friend:"null"===e.friend?null:"true"===e.friend}),e.currentPage&&(a=Number(e.currentPage)),i(Ze(s,a,r))}),[]);const l=e=>{i(Ze(s,e,o))};if(!e||n)return Object(L.jsx)(Q,{});const u=Math.ceil(r/s);return Object(L.jsxs)("div",{className:St.a.container,children:[t>1?Object(L.jsxs)("div",{className:St.a.buttonContainer,children:[Object(L.jsx)("img",{src:Et,alt:"",className:St.a.arrowButton,onClick:()=>l(t/t)}),Object(L.jsx)("img",{src:It,alt:"",className:St.a.arrowButton,onClick:()=>l(t-1)})]}):Object(L.jsx)("div",{className:St.a.buttonContainer}),Object(L.jsxs)("div",{className:St.a.usersList,children:[Object(L.jsx)(Rt,{onFilterChanged:e=>{i(Ze(s,1,e))}}),Object(L.jsx)("div",{className:St.a.currentPage,children:Object(L.jsx)("span",{children:Object(L.jsxs)("strong",{children:["Page ",t]})})}),e.map((e=>Object(L.jsx)(yt,{user:e},e.id)))]}),t!==u?Object(L.jsxs)("div",{className:St.a.buttonContainer,children:[Object(L.jsx)("img",{src:Ut,alt:"",className:St.a.arrowButton,onClick:()=>l(t+1)}),Object(L.jsx)("img",{src:Lt,alt:"",className:St.a.arrowButton,onClick:()=>l(u)})]}):Object(L.jsx)("div",{className:St.a.buttonContainer})]})}));const Ht=e=>({auth:e.auth.auth});var Wt=function(e){return Object(d.b)(Ht)((function(t){const{auth:s,...a}=t;return s?Object(L.jsx)(e,{...a}):Object(L.jsx)(S.a,{to:"/login"})}))};const zt=r.a.memo((e=>Object(L.jsx)(At,{})));var Gt=Object(mt.d)(_t,Wt)(zt),Jt=s(168),Bt=s.n(Jt),$t=s(78),Yt=s.n($t);const qt=r.a.memo((({handleSubmit:e,error:t,captchaURL:s})=>Object(L.jsxs)("form",{onSubmit:e,className:Bt.a.loginFormContainer,children:[Object(L.jsx)("div",{className:Yt.a.loginTitle,children:"Login"}),Object(L.jsxs)("div",{children:[le("Email","email",ie,void 0,void 0,[se]),le("Password","password",ie,"password",void 0,[se]),le(void 0,"rememberMe","input","checkbox","Remember me")]}),s&&Object(L.jsx)("img",{src:s,alt:""}),s&&le("Your captcha","captcha",ie,void 0,void 0,[se]),t&&Object(L.jsx)("div",{className:re.a.formSummaryError,children:t}),Object(L.jsx)("div",{children:Object(L.jsx)(E.a,{type:"default",htmlType:"submit",children:"Submit"})})]})));var Vt=Object(te.a)({form:"login"})(qt);var Kt=r.a.memo((({auth:e,userLogin:t,captchaURL:s})=>e?Object(L.jsx)(S.a,{to:"/profile"}):Object(L.jsx)("div",{className:Yt.a.loginContainer,children:Object(L.jsx)("div",{className:Yt.a.loginWrapper,children:Object(L.jsx)(Vt,{captchaURL:s,onSubmit:e=>{const{email:s,password:a,rememberMe:r,captcha:n}=e;t(s,a,r,n)}})})})));class Zt extends r.a.Component{render(){return Object(L.jsx)(Kt,{...this.props})}}var Qt=Object(d.b)((e=>({auth:R(e),captchaURL:M(e)})),{userLogin:(e,t,s,a)=>async r=>{const n=await p.login(e,t,s,a);if(0===n.data.resultCode)await r(N());else if(10===n.data.resultCode)await r(C());else{const e=n.data.messages[0]?n.data.messages[0]:"Something goes wrong :(";r(Object(u.a)("login",{_error:e}))}},setCaptchaUrl:C})(Zt),Xt=s(169),es=s(156);const ts="app/GET_INITIALIZED",ss={isInitialized:!1},as=()=>({type:ts});var rs=(e=ss,t)=>{switch(t.type){case ts:return{...e,isInitialized:!0};default:return e}};let ns,os={sendMessage:[],setStatus:[]};const is=e=>{let t=JSON.parse(e.data);os.sendMessage.forEach((e=>e(t)))},cs=()=>{us("Pending..."),setTimeout(hs,3e3)},ls=()=>{us("Ready")},ds=()=>{us("Error"),console.log("Refresh the Page")},us=e=>{os.setStatus.forEach((t=>t(e)))},js=()=>{var e,t,s,a;null===(e=ns)||void 0===e||e.removeEventListener("close",cs),null===(t=ns)||void 0===t||t.removeEventListener("message",is),null===(s=ns)||void 0===s||s.removeEventListener("open",ls),null===(a=ns)||void 0===a||a.removeEventListener("error",ds)},hs=()=>{var e;null!==ns&&(js(),null===(e=ns)||void 0===e||e.close());ns=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),us("Pending..."),ns.addEventListener("open",ls),ns.addEventListener("close",cs),ns.addEventListener("message",is),ns.addEventListener("error",ds)},ms={start(){hs()},stop(){var e;os.sendMessage=[],os.setStatus=[],js(),null===(e=ns)||void 0===e||e.close()},subscribe(e,t){os[e].push(t)},unsubscribe(e,t){os[e]=os[e].filter((e=>e!==t))},sendMessage(e){var t;null===(t=ns)||void 0===t||t.send(e)}};var bs=s(337);function ps(e,t){return!(e.sort()>t.sort()||e.sort()<t.sort())}const Os="chat/CHAT_MESSAGES_RECEIVED",fs="chat/SET_STATUS",gs={messages:[],status:""},xs=e=>({type:Os,payload:{messages:e}}),vs=e=>({type:fs,payload:{status:e}});let _s=null;const ws=e=>(null===_s&&(_s=t=>{e(xs(t))}),_s);let Ns=null;const Cs=e=>(null===Ns&&(Ns=t=>{e(vs(t))}),Ns),Ps=e=>async t=>{ms.sendMessage(e)};var ys=(e=gs,t)=>{switch(t.type){case Os:return!e.messages[e.messages.length-1]&&(!ps(e.messages,t.payload.messages)||t.payload.messages.length<=3)||1===t.payload.messages.length&&e.messages[e.messages.length-1]?{...e,messages:[...e.messages,...t.payload.messages.map((e=>({...e,id:Object(bs.a)()})))].filter(((e,t,s)=>t>=s.length-100))}:e.messages[e.messages.length-1]&&!ps(e.messages,t.payload.messages)&&e.messages[e.messages.length-1].message!==t.payload.messages[e.messages.length].message?{...e,messages:[...e.messages,...t.payload.messages.slice(e.messages.length-1).map((e=>({...e,id:Object(bs.a)()})))]}:{...e,messages:e.messages};case fs:return{...e,status:t.payload.status};default:return e}};const Fs=Object(mt.c)({auth:P,app:rs,form:es.a,usersPage:tt,profilePage:ye,chat:ys,error:xt});var Ss=Object(mt.e)(Fs,Object(mt.a)(Xt.a));const Is=e=>e.app.isInitialized;var Us=s(57),Es=s.n(Us);const Ls=e=>e.chat.messages,Ts=e=>e.chat.status;var ks=s(174);const Ds=r.a.memo((()=>{const e=Object(d.c)();return Object(a.useEffect)((()=>(e((async e=>{ms.start(),ms.subscribe("sendMessage",ws(e)),ms.subscribe("setStatus",Cs(e))})),()=>{e((async e=>{ms.stop(),ms.unsubscribe("sendMessage",ws(e)),ms.unsubscribe("setStatus",Cs(e))}))})),[]),Object(L.jsxs)("div",{className:Es.a.chat,children:[Object(L.jsx)(Rs,{}),Object(L.jsx)(As,{})]})})),Rs=r.a.memo((()=>{const e=Object(d.d)(Ls),[t,s]=Object(a.useState)(!1),r=Object(a.useRef)(null),n=()=>{var e;null===(e=r.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return Object(a.useEffect)((()=>{n()})),Object(a.useEffect)((()=>{t&&n()}),[e,t]),Object(L.jsxs)("div",{className:Es.a.allMessages,onScroll:e=>{const a=e.currentTarget;Math.abs(a.scrollHeight-a.scrollTop-a.clientHeight)<=300?!t&&s(!0):t&&s(!1)},children:[!e.length&&Object(L.jsx)(Q,{}),e.map((e=>Object(L.jsx)(Ms,{message:e},e.id))),Object(L.jsx)("div",{ref:r})]})})),Ms=r.a.memo((({message:e})=>Object(L.jsxs)("div",{children:[Object(L.jsxs)("div",{className:Es.a.chatMessage,children:[Object(L.jsx)("img",{src:e.photo||(ot(e.userName)?ee:X),alt:"",className:Es.a.profilePhoto}),Object(L.jsx)("span",{children:Object(L.jsx)("b",{children:e.userName})})]}),Object(L.jsx)("div",{children:Object(L.jsx)("span",{children:e.message})}),Object(L.jsx)("hr",{})]}))),As=r.a.memo((()=>{const[e,t]=Object(a.useState)(""),s=Object(d.d)(Ts),r=Object(d.c)(),n="Pending..."===s||"Error"===s;return Object(L.jsxs)("div",{className:Es.a.addMessageForm,children:[Object(L.jsx)("div",{className:Es.a.textInput,children:Object(L.jsx)(ks.a,{placeholder:"Hold Shift+Enter to send the message.\nOr use the button under the form.",value:e,onChange:e=>{"\n"!==e.currentTarget.value&&" "!==e.currentTarget.value&&t(e.currentTarget.value)},onKeyDown:s=>{if(!n&&s.shiftKey&&"Enter"===s.code){if(!e)return;s.preventDefault(),r(Ps(e)),t("")}},cols:15})}),Object(L.jsx)("div",{children:Object(L.jsx)(E.a,{type:"default",disabled:n,onClick:()=>{if(!n){if(!e)return;r(Ps(e)),t("")}},children:"Send"})})]})}));var Hs=Object(mt.d)(_t,Wt)(Ds);s(329);var Ws=r.a.memo((()=>Object(L.jsx)("div",{children:Object(L.jsx)(vt.a,{message:"Error",description:"Page doesn't exist",type:"error",showIcon:!0})})));class zs extends a.PureComponent{constructor(...e){super(...e),this.catchAllUnhandledErrors=e=>{if(e){console.error(e);const t=e.reason.message||e.reason.response.data.message;this.props.setError(t)}}}componentDidMount(){this.props.getInitialized(),window.addEventListener("unhandledrejection",this.catchAllUnhandledErrors)}componentWillUnmount(){window.removeEventListener("unhandledrejection",this.catchAllUnhandledErrors)}render(){return this.props.isInitialized?Object(L.jsxs)("div",{className:l.a.appContent,children:[Object(L.jsx)(H,{}),Object(L.jsx)(G,{}),Object(L.jsx)("main",{className:l.a.main,children:Object(L.jsxs)(S.d,{children:[Object(L.jsx)(S.b,{path:"/login",render:()=>Object(L.jsx)(Qt,{})}),Object(L.jsx)(S.b,{path:"/profile/:userID?",render:()=>Object(L.jsx)(Nt,{})}),Object(L.jsx)(S.b,{path:"/users",render:()=>Object(L.jsx)(Gt,{})}),Object(L.jsx)(S.b,{path:"/chat",render:()=>Object(L.jsx)(Hs,{})}),Object(L.jsx)(S.b,{exact:!0,path:"/",render:()=>Object(L.jsx)(S.a,{to:"/login"})}),Object(L.jsx)(S.b,{path:"*",render:()=>Object(L.jsx)(Ws,{})})]})}),Object(L.jsx)($,{})]}):Object(L.jsx)(Q,{})}}let Gs=Object(mt.d)(Object(d.b)((e=>({isInitialized:Is(e)})),{getInitialized:()=>async e=>{await e(N()),e(as())},setError:gt}),S.i)(zs);var Js=r.a.memo((()=>Object(L.jsx)(I.a,{children:Object(L.jsx)(d.a,{store:Ss,children:Object(L.jsx)(Gs,{})})})));o.a.render(Object(L.jsx)(Js,{}),document.getElementById("root")),i()},41:function(e,t,s){e.exports={headerContainer:"Header_headerContainer__y4aAf",siteInfo:"Header_siteInfo__d4-3b",logo:"Header_logo__IFq_S",networkName:"Header_networkName__1bGcF",loginInfo:"Header_loginInfo__ebxpo",loginContainer:"Header_loginContainer__2jGym",login:"Header_login__2XCRc"}},42:function(e,t,s){e.exports={sidebar:"Sidebar_sidebar__RJHOt",contentWrapper:"Sidebar_contentWrapper__3_dJU",link:"Sidebar_link__kUnHz",active:"Sidebar_active__1I1G0"}},57:function(e,t,s){e.exports={chat:"Chat_chat__3g1Mx",allMessages:"Chat_allMessages__1S8cO",chatMessage:"Chat_chatMessage__1GFfk",profilePhoto:"Chat_profilePhoto__Dnmjg",addMessageForm:"Chat_addMessageForm__3Zqki",textInput:"Chat_textInput__wr4ah"}},65:function(e,t,s){e.exports={controlsContainer:"FormControls_controlsContainer__3dcfZ",error:"FormControls_error__1o4q_",errorContainer:"FormControls_errorContainer__svhno",formSummaryError:"FormControls_formSummaryError__Q6rOd",formText:"FormControls_formText__3m0I1"}},78:function(e,t,s){e.exports={loginContainer:"Login_loginContainer__2YA73",loginWrapper:"Login_loginWrapper__3bCFA",loginTitle:"Login_loginTitle__mhzhR"}}},[[330,1,2]]]);
//# sourceMappingURL=main.c32b25fe.chunk.js.map